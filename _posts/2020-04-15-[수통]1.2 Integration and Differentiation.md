---
title: "[수리통계학] 1.2 Integration and Differentiation"
date: 2020-04-15 16:53:00 +0800
categories: [수업, 수리통계학]
tags: [수업, 수리통계학, 강의 리뷰]
toc: true
comments: true
use_math: true  	
---

$$
\def\df#1#2{\frac{#1}{#2}}
\def\si{\sigma}
\def\dt{\cdot}
\def\inf{\infty}
\def\F{\mathcal{F}}
\def\G{\mathcal{G}}
\def\R{\mathbb{R}}
\def\lam{\lambda}
\def\om{\omega}
\def\Om{\Omega}
\def\empty{\emptyset}
\def\lto{\longrightarrow}
\def\ds{\displaystyle}
\def\limn{\underset{n\to\inf}{lim}}
\def\E{\exists}
$$

# **1.2 Integration and Differentiation**

<br>

![관계](\assets\img\수통\integral.png)  

<center><cite>Riemann-Darboux's integration (in blue) and Lebesgue integration (in red).</cite></center>



## **Prelude**

Probability and Asymptotic Theory의 요지는  
1) random variable $X$의 함수 $g(X)$의 **expectation** = $E[g(X)]$를 구하는 것과  
2) random sample의 sample mean이 population mean으로 **확률수렴**한다는 것,  
\begin{aligned}
\bar{X}_n\overset{P}{\longrightarrow}\mu
\end{aligned}  
3) 그리고 이러한 수렴의 속도를 늦추고 scaling하면 표준정규분포로 **분포수렴**한다는 것이다.  
\begin{aligned}
\df{\sqrt{n}(\bar{X} _n-\mu)}{\si}\overset{d}{\lto}N(0,1)
\end{aligned}  

학부 때에는 이런 개념들을 그냥 받아들이고 가져다 썼다면,  
대학원에서는 이들의 출신과 그 특성을 보다 깊이 이해하는 것이 필요하며,  
그러기 위해서 먼저 1), $E[g(X)]$의 이해가 중요하다. 이는 다시  
$\int g(x)dF_x$로 표현할 수 있고, 학부 시절 $\int g(x)f(x)dx$로 익숙하다.   
그러나 이는 항상 성립하는 form이 아니므로 보다 general한 $\int g(x)dF_x$로 표현하는 것이 옳다.  

만약 $g(x)=1$이면 이는 $\int 1dF_x=\int f(x)dx=1$이 된다.  
여기서 $F$는 measure이므로 우리는 measure에 대한 이해가 필요하고,  
이러한 integration을 어떻게 할 수 있는지 알아야 한다. 

> The process of computing an integral is called [integration](https://mathworld.wolfram.com/Integration.html) (a more archaic term for [integration](https://mathworld.wolfram.com/Integration.html) is [quadrature](https://mathworld.wolfram.com/Quadrature.html)), and the approximate computation of an integral is termed [numerical integration](https://mathworld.wolfram.com/NumericalIntegration.html).

학창시절 때부터 학부 때까지 Riemann 적분만을 해왔지만  

> Riemann 적분: domain을 쪼개어 만든 <세로> 직사각형들의 넓이로 근사 

사실 통계학에서는 Riemann 적분이 항상 작동하지 않는다.  
이는 $x$값은 존재하지만 measure가 0인, discrete한 경우가 있기 때문이다.  

이러한 단점을 해결하기 위해 나온 것이 바로 Lebesgue 적분이다.  

> Lebesgue 적분: codomain, $f(x)$를 쪼개서 만든 <가로> 직사각형들의 넓이로 근사

앞서 배웠던 Lebesgue measure를 기억해보면  
$\lam((a,b))=F(b)-F(a)$의 꼴이며 이를 바탕으로 적분을 계산할 수 있고,  
$F$에 특정한 form(measure)을 부여하면 이것이 바로 density function이 된다.  

<br>

## **1.2.1 Integration Theory**

Theory about weighted sums of functions on a set $\Om$  
when the weights are specified by a mass distribution $\lam$. 

>*prev*) *simple function*  
>First, we define indicator function for $A\subset\Om$ as
>
>\begin{aligned}
>I_{A}(\om)=\begin{cases}1&\om\in A\\\\0&\om\notin A.\end{cases}
>\end{aligned}
>
>The class of simple functions is obtained by  
>taking linear combinations of indicators of measurable sets, that is,  
>
>\begin{align\*}
>\varphi(\om)=\sum\limits_{i=1}^{k}a_iI_{A_i}(\om),\tag{1}
>\end{align\*}
>
>where $A_1,...,A_k$ are measurable sets on $\Om$ and $a_1,...,a_k$ are real numbers.  
>Note this function is a Borel-function. 

<br>

1) Let $\varphi:\Om\to\R^+$ be a **nonnegative simple function** given (1) w.r.t. $\lam,$ <Lebesgue 적분>

\begin{align\*}
\ds\int \varphi d\lam=\sum\limits_{i=1}^{k}a_i\lam(A_i),\tag{2}​
\end{align\*}

where $A_i=f^{-1}(a_i)$. (or $A_i=\{x:a_i\leq f(x) < a_{i+1}\},$ where $0=a_1\leq a_2\leq ...\leq a_n$)  
The right-hand side of (2) is a weighted average of $a_i$'s with $\lam(A_i)$'s as weights. 

> $a_i$는 real number, $f$는 measurable function, $A_i$는 사건.  
> $\lam$은 measure. 앞서 Indicator들의 linear combination이었던 $\varphi$를  
> measure를 끌어와서 적분시키면 이러한 weighted average 꼴이 된다는 것이다.
>
> 직사각형의 면적을 떠올리면 $f(A_i)=a_i$가 사건 $A_i$에 대한  높이,  
> $\lam(A_i)$가 사건 $A_i$에 대한 너비의 개념이다. 

<br>

2) Let $f$ be a nonnegative Borel function and let $C_f$ be the collection of all nonnegative functions of the form (1) satisfying $\varphi(\om)\leq f(\om)$ for any $\om\in\Om$. The integral of $f$ w.r.t. $\lam$ is defined as 

\begin{aligned}
\ds\int fd\lam=sup \left\{ \ds\int \varphi d \lam :\varphi \in C_f\right\}.​
\end{aligned}

<u>How to interpret?</u> For any Borel function $f\geq0,$ there exists a sequence of simple functions  
$\varphi_1,\varphi_2,...$ such that $0\leq\varphi_i\leq f$  for all $i$ and  $\limn \ds\int \varphi_n d\lam =\ds\int fd\lam.$ 

> $f$와 $\varphi$의 관계는...
>
> 이해하기로는 indicator들의 linear combination인 simple function들은..   
> (step function ~ 직사각형들은 simple function의 한 예)  
> 모두 우리가 구하려는 분포함수 $f$보다는 아래에 있으나 무수히 쪼개어 더하면  
> $f$를 $\lam$에 대해 적분한 것과 같아진다는 뜻으로 보인다.   

다시, 르벡 적분이란 weighted sum of indicator function이다. 

\* A necessary and sufficient condition for the approximation is that for any $c\in\R$,   
the set ${s:f(s)\leq c}$ is in $\F$. 

<br>

3) How about a general Borel function $f$? (now $f$ can be negative.) We define

\begin{align\*}
\ds\int fd\lam=\ds\int f^+d\lam - \ds\int f^-d\lam,\tag{3}​
\end{align\*}

where $f^+=max\{f(\om),0\}$ and $f^-=max\{-f(\om),0\}.$

<br>

4) *Integrable*: a Borel function $f$ is said to be (Lebesgue) integrable w.r.t. $\lam$ if $\int|f|d\lam<\inf.$  

<br>

5) In probability and statistics, $\int XdP$ is denoted as $EX$ or $E(X)$.  
Furthermore, $\int f(x)dP$ is also denoted by $\int f(x)dF(x)$ if $F $ is the CDF of $P$ on $(\R^k,\mathcal{B}^k).$ 

> 그동안 $E[g(X)]=\int g(x)f(x)dx$ 라 했던 것은  
> 사실은 $E[g(X)]=\int g(x)dP=\int g(x)dF(x)$ 였다.  
> 사건에 대해 값을 부여한, probability measure에 대해 적분한 것이다.

<br>

6) Properties

Let $(\Om,\F,\lam)$ be a measure space and $f$ and $g$ be Borel function.

(i) If both $\int fd\lam$ and $\int gd\lam$ exist and $\int fd\lam + \int gd\lam $ is well defined, then $a,b\in\R,$

\begin{align\*}
\ds\int(af+bg)d\lam=a\ds\int fd\lam+b\ds\int gd\lam.​
\end{align\*}

(ii) If $f\leq g$ a.e. (a.e. means $ \E \;A=set\{s:f(s)\supset g(s)\},\;\lam(A)=0 $),  
then $\int fd\lam \leq \int gd\lam,$ provided that the integrals exists.

(iii) If $f\geq0$ a.e. & $\int fd\lam=0,$ then $f=0$ a.e. 

<br>

7) Examples

**Example 1.5** *Let $\Om$ be a countable set, $\F$ be all subsets of $\Om$, and $\lam$ be the counting measure. For any Borel function $f$, it can be shown that*

\begin{align\*}
\ds\int fd\lam=\sum\limits_{\om\in\Om}f(w).​
\end{align\*}

<br>

**Example 1.6** *If $\Om=\R$ and $\lam$ is the Lebesgue measure, then the Lebesgue integral of $f$ over an interval $[a,b]$ is written as $\int_{[a,b]}f(x)dx=\int_{a}^{b}f(x)dx,$ which agrees with the Riemann integral in calculus when the latter is well defined. However, there are functions for which the Lebesgue integrals are defined but not the Riemann integrals.*

> *ex*) for 유리수 $x$, $f(x)=1$ but for 무리수 $x$, $f(x)=0$  
> for $x\in[0,1]$, by Riemann Integral, area is 1 or 0: not defined $\leftrightarrow$ not integrable. 
>
> but by Lebesgue Integral, $f^{-1}(0)=$ irrational number & $f^{-1}(1)=$ rational number.  
> so $0\cdot \lam(f^{-1}(0))(=1)+1\cdot\lam (f^{-1}(1))(=0)=0.$ well defined $\leftrightarrow$ Lebesgue Integrable.
>
> remind that Lebesgue measure of countable set is 0. (구간에 대한 measure: 길이 $b-a$) 

<br>

 8) One important question: the following interchange of two operations is valid?

\begin{align\*}
\ds\int\limn f_nd\lam=\limn \ds\int f_n d\lam.\tag{4}​
\end{align\*}

*answer*: No. need some assumption so that those interchange is valid.

<br>



**Example 1.7** *(counter example) Consider $(\R,\mathcal{B})$ and the Lebesgue measure.  
Define $f_n(x)=nI_{[0,n^{-1}]}(x),$ $n=1,2,...$*     
*Then $\limn f_n(x)=0$ for all $x$ but $x=0$ (except for).  
Since the Lebesgue measure of a single point set is 0,  
 $\limn f_n(x)=0$ a.e. and $\int \limn f_n(x)dx=0.$  
On the other hand, $\int f_n(x)dx=1$ for any $n$ and hence $\limn \int f_n(x)dx=1.$*

> 이처럼 불일치한 경우가 있으므로 위의 interchange는 성립하지 않는다.

<br>





***

## **Reference**

[Probability Theory: Moments of a Distribution](https://www.bauer.uh.edu/rsusmel/phd/sR-3.pdf)





